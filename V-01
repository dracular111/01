-- üîÑ GitHub Auto-Reload Loader (multi-script + persistent update UI)

-- üìú Danh s√°ch script c·∫ßn t·∫£i & auto reload
local scripts = {
    { name = "FPS.lua",        url = "https://raw.githubusercontent.com/dracular111/01/main/FPS" },
    { name = "Gift-Gem.lua",   url = "https://raw.githubusercontent.com/dracular111/01/main/Track" },
    { name = "Event.lua",      url = "https://raw.githubusercontent.com/dracular111/01/main/Event" },
    -- { name = "Gift-Gem.lua", url = "https://raw.githubusercontent.com/dracular111/01/main/Gift-Gem" },
    -- { name = "Farm.lua",     url = "https://raw.githubusercontent.com/dracular111/01/main/Farm" },
}

local reloadDelay = 30 -- Th·ªùi gian ki·ªÉm tra c·∫≠p nh·∫≠t (gi√¢y)
local CoreGui = game:GetService("CoreGui")

-- üß± Hi·ªÉn th·ªã ho·∫∑c c·∫≠p nh·∫≠t th√¥ng b√°o UI (g√≥c ph·∫£i d∆∞·ªõi)
local function showNotification(text)
    local existingGui = CoreGui:FindFirstChild("GitHubUpdateNotice")
    local label

    if existingGui then
        label = existingGui:FindFirstChild("NoticeLabel")
        if label then
            label.Text = text
            return
        end
    end

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "GitHubUpdateNotice"
    screenGui.IgnoreGuiInset = true
    screenGui.ResetOnSpawn = false
    screenGui.Parent = CoreGui

    local textLabel = Instance.new("TextLabel")
    textLabel.Name = "NoticeLabel"
    textLabel.Size = UDim2.new(0, 600, 0, 60)
    textLabel.Position = UDim2.new(1, -610, 1, -80) -- g√≥c ph·∫£i d∆∞·ªõi
    textLabel.BackgroundTransparency = 0.3
    textLabel.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.Font = Enum.Font.Code
    textLabel.TextScaled = true
    textLabel.Text = text
    textLabel.TextXAlignment = Enum.TextXAlignment.Center
    textLabel.TextStrokeTransparency = 0.5
    textLabel.Parent = screenGui
end


-- ‚öôÔ∏è T·∫£i v√† th·ª±c thi code an to√†n
local function fetchAndRun(scriptInfo)
    local success, code = pcall(function()
        return game:HttpGet(scriptInfo.url)
    end)

    if not success then
        warn("[Loader] ‚ùå Failed to fetch:", scriptInfo.name)
        return nil
    end

    local func, err = loadstring(code)
    if not func then
        warn("[Loader] ‚ö†Ô∏è Compile error:", scriptInfo.name, err)
        return nil
    end

    local ok, execErr = pcall(func)
    if not ok then
        warn("[Loader] ‚ö†Ô∏è Runtime error:", scriptInfo.name, execErr)
    else
        print("[Loader] ‚úÖ Loaded:", scriptInfo.name)
    end

    return code
end


-- üöÄ Ch·∫°y l·∫ßn ƒë·∫ßu
local lastCodes = {}
for _, scriptInfo in ipairs(scripts) do
    lastCodes[scriptInfo.name] = fetchAndRun(scriptInfo)
end

showNotification("‚úÖ Scripts loaded at " .. os.date("%H:%M:%S"))


-- üîÅ T·ª± ƒë·ªông ki·ªÉm tra v√† reload khi c√≥ thay ƒë·ªïi
task.spawn(function()
    while task.wait(reloadDelay) do
        for _, scriptInfo in ipairs(scripts) do
            local ok, newCode = pcall(function()
                return game:HttpGet(scriptInfo.url)
            end)

            if ok and newCode and newCode ~= lastCodes[scriptInfo.name] then
                lastCodes[scriptInfo.name] = newCode
                fetchAndRun(scriptInfo)
                showNotification("üîÑ Updated " .. scriptInfo.name .. " at " .. os.date("%H:%M:%S"))
            end
        end
    end
end)
