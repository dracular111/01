-- ðŸ”’ Lock-FPS.lua (phiÃªn báº£n an toÃ n & gá»n nháº¹)
repeat task.wait() until game:IsLoaded()

-- ðŸ§¹ Dá»n sáº¡ch cÅ© (ngáº¯t connection + dá»«ng thread cÅ©)
pcall(function()
    if getgenv().fps_loop then
        getgenv().fps_loop:Disconnect()
        getgenv().fps_loop = nil
    end
    getgenv().fps_thread_stop = true
    task.wait(0.06)
    if game.CoreGui:FindFirstChild("FPS_UI") then
        game.CoreGui.FPS_UI:Destroy()
    end
end)

-- âš™ï¸ Cáº¥u hÃ¬nh
local TARGET_FPS = 10
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")

-- ðŸ–¥ UI chá»‰ cÃ³ chá»¯ FPS, giá»¯a mÃ n hÃ¬nh, siÃªu to
local ScreenGui = Instance.new("ScreenGui")
local Label = Instance.new("TextLabel")

ScreenGui.Name = "FPS_UI"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = CoreGui

Label.Size = UDim2.new(1, 0, 1, 0)
Label.Position = UDim2.new(0.5, 0, 0.5, 0)
Label.AnchorPoint = Vector2.new(0.5, 0.5)
Label.BackgroundTransparency = 1
Label.TextColor3 = Color3.fromRGB(255, 255, 255)
Label.Font = Enum.Font.Code
Label.TextScaled = false
Label.TextSize = 480 -- âš¡ siÃªu to (gáº¥p Ä‘Ã´i báº£n trÆ°á»›c)
Label.Text = "FPS: 00"
Label.TextXAlignment = Enum.TextXAlignment.Center
Label.TextYAlignment = Enum.TextYAlignment.Center
Label.TextStrokeTransparency = 0.4
Label.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
Label.Parent = ScreenGui

-- âš™ï¸ Set giá»›i háº¡n FPS náº¿u executor há»— trá»£
if setfpscap then
    pcall(setfpscap, TARGET_FPS)
end

-- ðŸ“‰ Ã‰p cá»©ng FPS báº±ng delay giá»¯a frame
local targetDelay = 1 / TARGET_FPS
local lastTick = tick()
local fps = 0

getgenv().fps_loop = RunService.RenderStepped:Connect(function(dt)
    fps = math.floor(1 / (dt > 0 and dt or 0.0001))
    local now = tick()
    local elapsed = now - lastTick
    if elapsed < targetDelay then
        task.wait(targetDelay - elapsed)
    end
    lastTick = tick()
end)

-- ðŸ”„ Cáº­p nháº­t FPS má»—i 0.5s, tá»± dá»«ng náº¿u Label bá»‹ xÃ³a
task.spawn(function()
    while task.wait(0.5) do
        if not Label or not Label.Parent then break end
        Label.Text = "FPS: " .. tostring(fps)
    end
end)

-- ðŸ’¤ Duy trÃ¬ setfpscap á»•n Ä‘á»‹nh
getgenv().fps_thread_stop = false
getgenv().fps_thread = task.spawn(function()
    while not getgenv().fps_thread_stop do
        if setfpscap then
            pcall(setfpscap, TARGET_FPS)
        end
        task.wait(5)
    end
end)
