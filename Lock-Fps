repeat task.wait() until game:IsLoaded()

-- üßπ Xo√° UI v√† thread c≈© n·∫øu ƒë√£ t·ªìn t·∫°i
if getgenv().fps_loop then
    getgenv().fps_loop:Disconnect() -- ng·∫Øt k·∫øt n·ªëi RenderStepped c≈©
end
if getgenv().fps_thread then
    getgenv().fps_thread:Cancel() -- h·ªßy v√≤ng while c≈©
end
if game.CoreGui:FindFirstChild("FPS_UI") then
    game.CoreGui.FPS_UI:Destroy()
end

-- ‚öôÔ∏è Gi·ªõi h·∫°n FPS mong mu·ªën
local TARGET_FPS = 10
if setfpscap then
    pcall(setfpscap, TARGET_FPS)
end

-- üß± T·∫°o UI hi·ªÉn th·ªã FPS
local CoreGui = game:GetService("CoreGui")
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local TextLabel = Instance.new("TextLabel")

ScreenGui.Name = "FPS_UI"
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = true
ScreenGui.Parent = CoreGui

Frame.Name = "FPSFrame"
Frame.Size = UDim2.new(0, 130, 0, 40)
Frame.Position = UDim2.new(1, -150, 0, 50)
Frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
Frame.BackgroundTransparency = 0.3
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui

TextLabel.Size = UDim2.new(1, 0, 1, 0)
TextLabel.BackgroundTransparency = 1
TextLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
TextLabel.Font = Enum.Font.Code
TextLabel.TextScaled = true
TextLabel.Text = "FPS: 0"
TextLabel.Parent = Frame

-- üìà Hi·ªÉn th·ªã FPS th·∫≠t
local RunService = game:GetService("RunService")
local fps = 0

getgenv().fps_loop = RunService.RenderStepped:Connect(function(dt)
    fps = math.floor(1 / dt)
end)

task.spawn(function()
    while task.wait(0.5) do
        TextLabel.Text = "FPS: " .. fps
    end
end)

-- üîÑ Gi·ªØ FPS th·∫•p (thread ri√™ng, c√≥ th·ªÉ hu·ª∑)
getgenv().fps_thread = task.spawn(function()
    while true do
        if setfpscap then
            pcall(setfpscap, TARGET_FPS)
        end
        task.wait(5)
    end
end)
