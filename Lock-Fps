repeat task.wait() until game:IsLoaded()

-- üßπ X√≥a m·ªçi th·ª© c≈© tr∆∞·ªõc
if getgenv().fps_loop then getgenv().fps_loop:Disconnect() end
if getgenv().fps_thread then task.cancel(getgenv().fps_thread) end
if game.CoreGui:FindFirstChild("FPS_UI") then
    game.CoreGui.FPS_UI:Destroy()
end

-- ‚öôÔ∏è C·∫•u h√¨nh
local TARGET_FPS = 20 -- ‚ö†Ô∏è ch·ªânh ·ªü ƒë√¢y
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")

-- üñ•Ô∏è UI
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Label = Instance.new("TextLabel")
local Notice = Instance.new("TextLabel")

ScreenGui.Name = "FPS_UI"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = CoreGui

Frame.Size = UDim2.new(0, 200, 0, 90)
Frame.Position = UDim2.new(1, -220, 0, 50)
Frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
Frame.BackgroundTransparency = 0.3
Frame.Parent = ScreenGui

-- üìä Nh√£n FPS ch√≠nh (to g·∫•p 3 l·∫ßn v√† tr·∫Øng)
Label.Size = UDim2.new(1, 0, 0.65, 0)
Label.Position = UDim2.new(0, 0, 0, 0)
Label.BackgroundTransparency = 1
Label.TextColor3 = Color3.fromRGB(255, 255, 255) -- ‚ö™ M√†u tr·∫Øng
Label.Font = Enum.Font.Code
Label.TextScaled = true
Label.TextWrapped = true
Label.Text = "FPS: ..."
Label.TextStrokeTransparency = 0.6 -- vi·ªÅn m·ªù gi√∫p d·ªÖ ƒë·ªçc h∆°n
Label.TextSize = 72 -- üí• c·ª° ch·ªØ to g·∫•p 3 l·∫ßn m·∫∑c ƒë·ªãnh
Label.Parent = Frame

-- üîî D√≤ng th√¥ng b√°o b√™n d∆∞·ªõi
Notice.Size = UDim2.new(1, 0, 0.35, 0)
Notice.Position = UDim2.new(0, 0, 0.65, 0)
Notice.BackgroundTransparency = 1
Notice.TextColor3 = Color3.fromRGB(255, 255, 0)
Notice.Font = Enum.Font.Code
Notice.TextScaled = true
Notice.TextWrapped = true
Notice.Text = "ƒêang t·∫£i t·ª´ GitHub..."
Notice.Parent = Frame

-- üîÑ C·∫≠p nh·∫≠t nh√£n khi reload script
task.spawn(function()
    Notice.Text = "C·∫≠p nh·∫≠t script m·ªõi nh·∫•t ‚úÖ"
    task.wait(3)
    Notice.Text = "Gi·ªõi h·∫°n FPS: " .. TARGET_FPS
end)

-- ‚öôÔ∏è Gi·ªõi h·∫°n FPS (n·∫øu executor h·ªó tr·ª£)
if setfpscap then pcall(setfpscap, TARGET_FPS) end

-- üìâ C√°ch √©p c·ª©ng FPS (RenderStepped delay)
local targetDelay = 1 / TARGET_FPS
local lastTick = tick()
local fps = 0

getgenv().fps_loop = RunService.RenderStepped:Connect(function(dt)
    fps = math.floor(1 / dt)
    local now = tick()
    local elapsed = now - lastTick
    if elapsed < targetDelay then
        task.wait(targetDelay - elapsed)
    end
    lastTick = tick()
end)

-- üßÆ C·∫≠p nh·∫≠t hi·ªÉn th·ªã FPS m·ªói 0.5s
task.spawn(function()
    while task.wait(0.5) do
        Label.Text = "FPS: " .. tostring(fps)
    end
end)

-- üí§ Gi·ªØ setfpscap lu√¥n ·ªïn ƒë·ªãnh
getgenv().fps_thread = task.spawn(function()
    while true do
        if setfpscap then pcall(setfpscap, TARGET_FPS) end
        task.wait(5)
    end
end)
