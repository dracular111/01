 local plrs = game:GetService("Players")
local plr = plrs.LocalPlayer
local tpService = game:GetService("TeleportService")
local getPlayers = plrs:GetPlayers()
local PlayerInServer = #getPlayers
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local placeId = game.PlaceId
local currentJobId = game.JobId
local uis = game:GetService("UserInputService")
local vim = game:GetService("VirtualInputManager")
local runService = game:GetService("RunService")

-- Ch·ªçn API ng·∫´u nhi√™n gi·ªØa Asc v√† Desc
local function getRandomAPI()
	local sortOrder = (math.random(1, 2) == 1) and "Asc" or "Desc"
	return string.format(
		"https://games.roblox.com/v1/games/%s/servers/Public?sortOrder=%s&limit=100&excludeFullGames=true",
		placeId,
		sortOrder
	)
end
 
-- H√†m l·∫•y danh s√°ch server h·ª£p l·ªá (c√≥ slot tr·ªëng)
local function getValidServers()
	local servers
	local attempts = 0
	repeat
		task.wait(5)
		local url = getRandomAPI()
 
		local success, response = pcall(function()
			return HttpService:JSONDecode(game:HttpGet(url)).data
		end)
 
		if success and response and #response > 0 then
			servers = {}
			for _, server in pairs(response) do
				if server.playing < server.maxPlayers and server.id ~= currentJobId then
					table.insert(servers, server)
				end
			end
			print("‚úÖ S·ªë l∆∞·ª£ng server h·ª£p l·ªá:", #servers)
		else
			warn("‚ö†Ô∏è Kh√¥ng l·∫•y ƒë∆∞·ª£c danh s√°ch server! Th·ª≠ l·∫°i...")
		end
 
		attempts += 1
	until (servers and #servers > 0) or attempts >= 5
 
	return servers
end
 
-- H√†m rejoin n·∫øu kh√¥ng t√¨m ƒë∆∞·ª£c server
local function rejoinServer()
	TeleportService:Teleport(placeId, player)
end
 
-- Retry flag ƒë·ªÉ tr√°nh spam
local retrying = false
 
-- T·ª± ƒë·ªông th·ª≠ l·∫°i n·∫øu teleport th·∫•t b·∫°i
TeleportService.TeleportInitFailed:Connect(function(failedPlayer, teleportResult, errorMessage)
	if failedPlayer == player and not retrying then
		retrying = true
		warn("‚ö†Ô∏è Teleport th·∫•t b·∫°i:", teleportResult, "-", errorMessage)
		task.wait(3)
		print("üîÅ ƒêang th·ª≠ l·∫°i teleport...")
		serverHop()
		retrying = false
	end
end)
 
-- H√†m nh·∫£y sang server kh√°c
function serverHop()
	local servers = getValidServers()
	if not servers or #servers == 0 then
		warn("‚ùå Kh√¥ng t√¨m th·∫•y server n√†o c√≥ ch·ªó tr·ªëng sau nhi·ªÅu l·∫ßn th·ª≠!")
		rejoinServer()
		return
	end
 
	local newServer = servers[math.random(1, #servers)]
	print("üîÑ ƒêang chuy·ªÉn sang server:", newServer.id)
	TeleportService:TeleportToPlaceInstance(placeId, newServer.id, player)
end

script_key=FlGZRfbYysjtmHRbaXzEqlOVABjLTUuP"";
setfpscap(5)  -- number = fps

getgenv().bgsInfConfig = {
    AUTO_UPDATE_RESTART = true,
    PURCHASE_ALIENSHOP = true,
    USE_ROYAL_KEY = true,
    USE_GOLDEN_KEY = true,
    USE_MYSTERY_BOX = true,
    RARITY_TO_DELETE = {"Common", "Unique", "Rare"},  -- Delete if max inventory
    LEGENDARY_TIER_TO_DELETE = 2,  -- Ignore Shiny/Mythic/Shiny Mythic
    RESTOCK_SHOP = "Blackmarket", 
    PURCHASE_BLACKMARKET = true,
    POTIONS_TO_CRAFT = {"Coins", "Mythic", "Lucky", "Speed"},

    RIFT_EGGS = {"Aura Egg", "Bunny Egg", "Pastel Egg", "Nightmare Egg"},  -- Add Any Egg Name
    HATCH_1X_EGG = "Pastel Egg",  -- Hatch 1x Egg If No Rift & FARM_MIN_GEMS Completed

    WEBHOOK_URL = "https://discord.com/api/webhooks/1362995913080963072/8Tb6WNq581gS3l-tifSkgZ2ZdYP1oQUd9XI62BrbYOTFvL94ZY4SkAEEIa8y8c_VJR3l",
    DISCORD_ID = "",
    WEBHOOK_RARITY = { Common = false, Unique = false, Rare = false, Epic = false, Legendary = true, Secret = true },
    LEGENDARY_TIER = 3,  -- Ignore if set not set "Legendary"
    SHOW_PET_WEBHOOK_USERNAME = true,  -- shows username in private webhook only
}

loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/3dc52e6a2fc4f671b66757e93f4fd38b.lua"))()
