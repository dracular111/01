repeat task.wait() until game:IsLoaded()

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

if _G.DIAMOND_SENDER_RAN then
	warn("â›” Script Ä‘Ã£ Ä‘Æ°á»£c cháº¡y trÆ°á»›c Ä‘Ã³!")
	return
end
_G.DIAMOND_SENDER_RAN = true

----------------------------------------------------------
-- ğŸ’ AUTO DIAMOND SENDER (by Heo)
----------------------------------------------------------

-- Láº¥y dá»¯ liá»‡u kim cÆ°Æ¡ng
local diamondsStat = player:WaitForChild("leaderstats"):FindFirstChild("ğŸ’ Diamonds")
if not diamondsStat then
	warn("âŒ KhÃ´ng tÃ¬m tháº¥y chá»‰ sá»‘ Diamonds.")
	return
end

-- Danh sÃ¡ch ngÆ°á»i nháº­n
local receivers = { "congahpz000", "congahpz001" }

-- Module gá»‘c
local Client = ReplicatedStorage:WaitForChild("Library"):WaitForChild("Client")
local Network = require(Client.Network)
local SaveModule = require(Client.Save)

-- HÃ m tÃ¬m UID kim cÆ°Æ¡ng
local function getDiamondsUID()
	local save = SaveModule.Get()
	local inv = save and save.Inventory and save.Inventory.Currency
	if not inv then return nil end
	for uid, v in pairs(inv) do
		if v.id == "Diamonds" then
			return uid
		end
	end
	return nil
end

local diamondsUID = getDiamondsUID()
if not diamondsUID then
	warn("âŒ KhÃ´ng tÃ¬m tháº¥y Diamonds UID.")
	return
end

-- HÃ m gá»­i kim cÆ°Æ¡ng
local function sendDiamonds(amount, receiver)
	local success = false
	for i = 1, 3 do -- thá»­ tá»‘i Ä‘a 3 láº§n Ä‘á»ƒ trÃ¡nh lá»—i máº¡ng
		local ok, res = pcall(function()
			return Network.Invoke("Mailbox: Send", receiver, "Bless", "Currency", diamondsUID, amount)
		end)
		if ok and res then
			success = true
			break
		end
		task.wait(0.3)
	end
	return success
end

-- VÃ²ng láº·p chÃ­nh
task.spawn(function()
	while task.wait(5) do
		local diamonds = diamondsStat.Value
		if diamonds > 100500000 then -- 100M + buffer 500k
			local receiver = receivers[math.random(1, #receivers)]
			local amountToSend = diamonds - 500000 -- giá»¯ láº¡i 500k lÃ m dá»± trá»¯

			local success = sendDiamonds(amountToSend, receiver)
			if success then
				print(("ğŸ“¤ ÄÃ£ gá»­i %s ğŸ’ cho ngÆ°á»i dÃ¹ng: %s"):format(amountToSend, receiver))
			else
				warn("âš ï¸ Gá»­i tháº¥t báº¡i, sáº½ thá»­ láº¡i sau.")
			end
			task.wait(10)
		end
	end
end)
